{"version":3,"sources":["app.js","dnd-draggable-item.js","dnd-drop-target.js","dnd-item.js","dnd-list-impl.js","dnd-list.js","dnd-service.js","dnd-test.js","environment.js","main.js","resources/index.js","/Users/alexanderkarmanov/Documents/Jahia/aurilia/dnd/src/app.html","/Users/alexanderkarmanov/Documents/Jahia/aurilia/dnd/src/dnd-item.html","/Users/alexanderkarmanov/Documents/Jahia/aurilia/dnd/src/dnd-list-impl.html","/Users/alexanderkarmanov/Documents/Jahia/aurilia/dnd/src/dnd-test.html"],"names":["App","list","type","id","item","draggable","list2","list3","message","toString","console","log","JSON","stringify","DraggableItem","defaultBindingMode","twoWay","oneWay","element","dndService","effect","enforceTypeCompatibility","onDrag","event","index","onDragCallback","onDragStart","initiateDragging","topLevelItem","dataTransfer","setData","dropEffect","onDragStartCallback","onDragEnd","cleanUpPlaceHolder","onDragEndCallback","DropTarget","onDragOver","preventDefault","stopPropagation","addPlaceHolder","onDragOverCallback","onDrop","undefined","data","placeholder","getPlaceHolder","handleDrop","parse","getData","splice","onDropCallback","nextSibling","tagName","getSiblingPositionInList","previousSibling","sibling","childNodes","i","length","DndItem","Element","style","opacity","DndListImpl","DragAndDropList","droppedCallback","DragAndDropService","DOM","isDragging","targetList","targetIndex","canDrop","push","createPlaceholder","createElement","className","target","classList","contains","listHolder","parentNode","isEqualNode","appendChild","isMouseInFirstHalf","insertBefore","insertAfter","removeChild","targetNode","mousePointer","offsetY","layerY","targetSize","offsetHeight","targetPosition","offsetTop","newNode","referenceNode","idExistsInBranch","l","DndTest","debug","testing","configure","Promise","config","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot"],"mappings":";;;;;;;;;;;;;KAAaA,cAAAA;AACX,iBAAc;AAAA;;AAAA,QAIdC,IAJc,GAIP,CACP;AACCC,UAAO,GADR;AAECC,QAAK,GAFN;AAGCC,UAAO,SAHR;AAICC,eAAY,KAJb;AAKCJ,UAAM,CACL;AACCC,WAAO,GADR;AAECE,WAAO,QAFR;AAGCD,SAAK,GAHN;AAICE,gBAAY,IAJb;AAKCJ,WAAO,CACN;AACCC,YAAO,GADR;AAECC,UAAK,GAFN;AAGCC,YAAO,WAHR;AAICC,iBAAY,IAJb;AAKCJ,YAAO;AALR,MADM,EAQN;AACCC,YAAO,GADR;AAECC,UAAK,GAFN;AAGCC,YAAO,WAHR;AAICC,iBAAY,IAJb;AAKCJ,YAAO;AALR,MARM;AALR,KADK;AALP,IADO,EA+BP;AACCC,UAAO,GADR;AAEIC,QAAK,GAFT;AAGIC,UAAO,SAHX;AAIIC,eAAY,IAJhB;AAKCJ,UAAO,CACN;AACCC,WAAO,GADR;AAECE,WAAO,QAFR;AAGCD,SAAK,GAHN;AAICE,gBAAY;AAJb,KADM;AALR,IA/BO,CAJO;AAAA,QAmDfC,KAnDe,GAmDP,CACP;AACCJ,UAAO,GADR;AAECC,QAAK,GAFN;AAGCC,UAAO,SAHR;AAICC,eAAY,IAJb;AAKCJ,UAAM,CACL;AACCC,WAAO,GADR;AAECE,WAAO,QAFR;AAGCD,SAAK,GAHN;AAICE,gBAAY,IAJb;AAKCJ,WAAO,CACN;AACCC,YAAO,GADR;AAECC,UAAK,GAFN;AAGCC,YAAO,WAHR;AAICC,iBAAY,IAJb;AAKCJ,YAAO;AALR,MADM,EAQN;AACCC,YAAO,GADR;AAECC,UAAK,GAFN;AAGCC,YAAO,WAHR;AAICC,iBAAY,IAJb;AAKCJ,YAAO;AALR,MARM;AALR,KADK;AALP,IADO,EA+BP;AACCC,UAAO,GADR;AAEIC,QAAK,IAFT;AAGIC,UAAO,SAHX;AAIIC,eAAY,IAJhB;AAKCJ,UAAO;AALR,IA/BO,CAnDO;AAAA,QA2FfM,KA3Fe,GA2FP,CAAC,EAAD,CA3FO;;AACZ,QAAKC,OAAL,GAAe,kCAAf;AACD;;gBA2FFC,6BAASR,MAAM;AACdS,WAAQC,GAAR,CAAYC,KAAKC,SAAL,CAAeZ,IAAf,CAAZ;AACA,UAAOW,KAAKC,SAAL,CAAeZ,IAAf,CAAP;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KC/FWa,wBAAAA,wBAIX,gCAAS,EAAEC,oBAAoB,8BAAYC,MAAlC,EAAT,WACA,gCAAS,EAAED,oBAAoB,8BAAYC,MAAlC,EAAT,WACA,gCAAS,EAAED,oBAAoB,8BAAYE,MAAlC,EAAT,WACA,gCAAS,EAAEF,oBAAoB,8BAAYE,MAAlC,EAAT;AAED,yBAAYC,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,QARjCC,MAQiC,GARxB,MAQwB;AAAA,QAPjCC,wBAOiC,GAPN,IAOM;;AAAA;;AAAA;;AAAA;;AAAA;;AAChC,QAAKH,OAAL,GAAeA,OAAf;AACA,QAAKC,UAAL,GAAkBA,UAAlB;AACA;;0BAEDG,yBAAOC,OAAOC,OAAO;AACpB,QAAKC,cAAL,CAAoBF,KAApB,EAA2BC,KAA3B;AACA;;0BAEDE,mCAAYH,OAAOC,OAAO;AACzB,QAAKL,UAAL,CAAgBQ,gBAAhB,CACC,KAAK1B,IADN,EAECuB,KAFD,EAGC,KAAKN,OAHN,EAIC,KAAKU,YAJN;;AAMEL,SAAMM,YAAN,CAAmBC,OAAnB,CAA2B,MAA3B,EAAmClB,KAAKC,SAAL,CAAe,KAAKZ,IAAL,CAAUuB,KAAV,CAAf,CAAnC;AACAD,SAAMM,YAAN,CAAmBE,UAAnB,GAAgC,KAAKX,MAArC;AACA,QAAKY,mBAAL,CAAyBT,KAAzB,EAAgCC,KAAhC;AACF,UAAO,IAAP;AACA;;0BAEDS,+BAAUV,OAAOC,OAAO;AACvB,QAAKL,UAAL,CAAgBe,kBAAhB;AACA,QAAKC,iBAAL,CAAuBZ,KAAvB,EAA8BC,KAA9B;AACA;;0BAEDW,+CAAkBZ,OAAOC,OAAO,CAAE;;0BAElCQ,mDAAoBT,OAAOC,OAAO,CAAE;;0BAEpCC,yCAAeF,OAAOC,OAAO,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCxCnBY,qBAAAA,qBAIX,gCAAS,EAAErB,oBAAoB,8BAAYC,MAAlC,EAAT,WACA,gCAAS,EAAED,oBAAoB,8BAAYE,MAAlC,EAAT;AAED,sBAAYC,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,QANjCC,MAMiC,GANxB,MAMwB;AAAA,QALjCC,wBAKiC,GALN,KAKM;;AAAA;;AAAA;;AAChC,QAAKH,OAAL,GAAeA,OAAf;AACA,QAAKC,UAAL,GAAkBA,UAAlB;AACA;;uBAEDkB,iCAAWd,OAAOC,OAAO;AACxBD,SAAMe,cAAN;AACAf,SAAMgB,eAAN;AACE,QAAKpB,UAAL,CAAgBqB,cAAhB,CAA+BjB,KAA/B,EAAsC,KAAKL,OAA3C,EAAoD,KAAKjB,IAAzD;AACAsB,SAAMM,YAAN,CAAmBE,UAAnB,GAAgC,KAAKX,MAArC;AACA,QAAKqB,kBAAL,CAAwBlB,KAAxB,EAA+BC,KAA/B;AACA,UAAO,KAAP;AACF;;uBAEDkB,yBAAOnB,OAAOC,OAAO;AACpBD,SAAMe,cAAN;AACAf,SAAMgB,eAAN;;AAEA,OAAI,KAAKlB,wBAAT,EAAmC;AAC/B,QAAI,KAAKpB,IAAL,CAAUuB,KAAV,EAAiBtB,IAAjB,KAA0ByC,SAA1B,IAAuC,KAAK1C,IAAL,CAAUuB,KAAV,EAAiBtB,IAAjB,KAA0B0C,KAAK1C,IAA1E,EAAgF;AAC/E;AACA;AACD;;AAED,OAAI2C,cAAc,KAAK1B,UAAL,CAAgB2B,cAAhB,EAAlB;;AAEH,OAAID,gBAAgB,IAApB,EAA0B;AACzB;AACA;;AAGE,OAAI,CAAC,KAAK1B,UAAL,CAAgB4B,UAAhB,CAA2B,KAAK9C,IAAhC,EAAsCuB,KAAtC,CAAL,EAAmD;AAClD;AACA;;AAEJ,OAAIoB,OAAOhC,KAAKoC,KAAL,CAAWzB,MAAMM,YAAN,CAAmBoB,OAAnB,CAA2B,MAA3B,CAAX,CAAX;;AAEG,OAAI,KAAKhD,IAAL,CAAU,CAAV,EAAaC,IAAb,KAAsByC,SAA1B,EAAqC;AACpC,SAAK1C,IAAL,CAAUiD,MAAV,CAAiB,CAAjB,EAAoB,CAApB,EAAuBN,IAAvB;AACA,SAAKO,cAAL,CAAoB5B,KAApB;AACA;AACA;;AAEJ,OAAIsB,YAAYO,WAAZ,CAAwBC,OAAxB,KAAoC,UAAxC,EAAoD;AACnD,SAAKpD,IAAL,CAAUiD,MAAV,CAAiB,KAAKI,wBAAL,CAA8BT,YAAYO,WAA1C,CAAjB,EAAyE,CAAzE,EAA4ER,IAA5E;AACA,IAFD,MAGK,IAAIC,YAAYU,eAAZ,CAA4BF,OAA5B,KAAwC,UAA5C,EAAwD;AAC5D,SAAKpD,IAAL,CAAUiD,MAAV,CAAiB,KAAKI,wBAAL,CAA8BT,YAAYU,eAA1C,IAA6D,CAA9E,EAAiF,CAAjF,EAAoFX,IAApF;AACA,IAFI,MAGA;AACJlC,YAAQC,GAAR,CAAY,WAAZ;AACA;;AAEC,QAAKQ,UAAL,CAAgBe,kBAAhB;AACA,QAAKiB,cAAL,CAAoB5B,KAApB;AACF;;uBAED+B,6DAAyBE,SAAS;AACjC,OAAIrD,KAAKqD,QAAQC,UAAR,CAAmB,CAAnB,EAAsBtD,EAA/B;AACA,QAAK,IAAIuD,IAAI,CAAb,EAAgBA,IAAI,KAAKzD,IAAL,CAAU0D,MAA9B,EAAsCD,GAAtC,EAA2C;AAC1C,QAAI,KAAKzD,IAAL,CAAUyD,CAAV,EAAavD,EAAb,KAAoBA,EAAxB,EAA4B;AAC3B,YAAOuD,CAAP;AACA;AACD;AACD,UAAO,CAAP;AACA;;uBAEDP,yCAAe5B,OAAOC,OAAO,CAAE;;uBAE/BiB,iDAAmBlB,OAAOC,OAAO,CAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCzEvBoC,kBAAAA,kBADZ,8BAAOC,OAAP;;;AAKA,mBAAY3C,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,2CAChC,0BAAMD,OAAN,EAAeC,UAAf,CADgC;AAEhC;;oBAEDa,mDAAoBT,OAAOC,OAAO;AACjC,QAAKN,OAAL,CAAa4C,KAAb,CAAmBC,OAAnB,GAA6B,GAA7B;AACA;;oBAED5B,+CAAkBZ,OAAOC,OAAO;AAC/B,QAAKN,OAAL,CAAa4C,KAAb,CAAmBC,OAAnB,GAA6B,CAA7B;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCdWC,sBAAAA,sBADZ,8BAAOH,OAAP;;;AAEA,uBAAY3C,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,2CAChC,uBAAMD,OAAN,EAAeC,UAAf,CADgC;AAEhC;;;;;;;;;;;;;;;;;;;KCNW8C,0BAAAA;AAOZ,2BAAY/C,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,QANjCC,MAMiC,GANxB,MAMwB;AAAA,QALjCC,wBAKiC,GALN,IAKM;;AAChC,QAAKH,OAAL,GAAeA,OAAf;AACA,QAAKC,UAAL,GAAkBA,UAAlB;AACAT,WAAQC,GAAR,CAAY,uBAAZ;AACA;;4BAEDW,yBAAOC,OAAO;AACbb,WAAQC,GAAR,CAAY,cAAZ;AACA;;4BAEDe,mCAAYH,OAAOC,OAAO;AACzB,QAAKL,UAAL,CAAgBQ,gBAAhB,CAAiC,KAAK1B,IAAtC,EAA4CuB,KAA5C;;AAEED,SAAMM,YAAN,CAAmBC,OAAnB,CAA2B,MAA3B,EAAmClB,KAAKC,SAAL,CAAe,KAAKZ,IAAL,CAAUuB,KAAV,CAAf,CAAnC;AACAD,SAAMM,YAAN,CAAmBE,UAAnB,GAAgC,KAAKX,MAArC;AACF,UAAO,IAAP;AACA;;4BAEDiB,iCAAWd,OAAOC,OAAO;AACxBD,SAAMe,cAAN;AACAf,SAAMgB,eAAN;AACE,QAAKpB,UAAL,CAAgBqB,cAAhB,CAA+BjB,KAA/B,EAAsC,KAAKL,OAA3C;AACAK,SAAMM,YAAN,CAAmBE,UAAnB,GAAgC,KAAKX,MAArC;;AAEA,UAAO,KAAP;AACF;;4BAEDsB,yBAAOnB,OAAOC,OAAO;AAEpBD,SAAMe,cAAN;AACAf,SAAMgB,eAAN;AACAf,WAAQA,UAAUmB,SAAV,GAAsB,CAAtB,GAA0BnB,KAAlC;AACE,OAAIoB,OAAOhC,KAAKoC,KAAL,CAAWzB,MAAMM,YAAN,CAAmBoB,OAAnB,CAA2B,MAA3B,CAAX,CAAX;;AAIA,OAAI,KAAK5B,wBAAT,EAAmC;AAEjC,QAAI,KAAKpB,IAAL,CAAUuB,KAAV,EAAiBtB,IAAjB,KAA0ByC,SAA1B,IAAuC,KAAK1C,IAAL,CAAUuB,KAAV,EAAiBtB,IAAjB,KAA0B0C,KAAK1C,IAA1E,EAAgF;AAC/E;AACA;AACF;AACD,QAAKD,IAAL,CAAUiD,MAAV,CAAiB1B,KAAjB,EAAwB,CAAxB,EAA2BoB,IAA3B;AACA,QAAKzB,UAAL,CAAgB4B,UAAhB;AACA,QAAKmB,eAAL,CAAqB3C,KAArB;AACF;;4BAED2C,2CAAgB3C,OAAO,CAAE;;;;;;;;;;;;;;;;;;;;;KCpDb4C,6BAAAA,6BADZ;AASA,8BAAYC,GAAZ,EAAiB;AAAA;;AAAA,QAPjBC,UAOiB,GAPJ,KAOI;AAAA,QANjBpE,IAMiB,GANV,EAMU;AAAA,QALjBuB,KAKiB,GALT,CAAC,CAKQ;AAAA,QAJjBqB,WAIiB,GAJH,IAIG;AAAA,QAHjB3B,OAGiB,GAHP,IAGO;AAAA,QAFjBU,YAEiB,GAFF,KAEE;;AAChB,QAAKwC,GAAL,GAAWA,GAAX;AACA;;+BAEDzC,6CAAiB1B,MAAMuB,OAAON,SAASU,cAAc;AACpD,QAAK3B,IAAL,GAAYA,IAAZ;AACA,QAAKuB,KAAL,GAAaA,KAAb;AACA,QAAKN,OAAL,GAAeA,OAAf;AACA,QAAKU,YAAL,GAAoBA,YAApB;AACA;;+BAEDmB,iCAAWuB,YAAYC,aAAa;AACnC,OAAI,KAAKC,OAAL,CAAaF,UAAb,EAAyBC,WAAzB,CAAJ,EAA2C;AAC1C,SAAKtE,IAAL,CAAUiD,MAAV,CAAiB,KAAK1B,KAAtB,EAA6B,CAA7B;;AAEA,QAAI,KAAKvB,IAAL,CAAU0D,MAAV,KAAqB,CAArB,IAA0B,KAAK/B,YAAnC,EAAiD;AAChD,UAAK3B,IAAL,CAAUwE,IAAV,CAAe,EAAf;AACA;AACD,WAAO,IAAP;AACA;AACD,UAAO,KAAP;AACA;;+BAEDC,iDAAoB;AACnB,OAAIxD,UAAU,gBAAIyD,aAAJ,CAAkB,KAAlB,CAAd;AACAzD,WAAQ0D,SAAR,GAAoB,gBAApB;AACA,UAAO1D,OAAP;AACA;;+BAEDsB,yCAAejB,OAAOL,SAASjB,MAAM;AACpC,OAAIsB,MAAMsD,MAAN,CAAaC,SAAb,CAAuBC,QAAvB,CAAgC,SAAhC,CAAJ,EAAgD;AAC/C,QAAIC,aAAazD,MAAMsD,MAAN,CAAaI,UAAb,CAAwBA,UAAzC;;AAEA,QAAI,KAAKpC,WAAL,KAAqB,IAAzB,EAA+B;AAC9B,UAAKA,WAAL,GAAmB,KAAK6B,iBAAL,EAAnB;AACA;;AAED,QAAInD,MAAMsD,MAAN,CAAaK,WAAb,CAAyB,KAAKhE,OAA9B,CAAJ,EAA4C;AAC3C;AACA,KAFD,MAGK,IAAIjB,KAAK,CAAL,EAAQC,IAAR,KAAiByC,SAArB,EAAgC;AACpCqC,gBAAWG,WAAX,CAAuB,KAAKtC,WAA5B;AACA,KAFI,MAGA;AACJ,SAAI,KAAKuC,kBAAL,CAAwB7D,KAAxB,EAA+BA,MAAMsD,MAAN,CAAaI,UAA5C,CAAJ,EAA6D;AAC5DD,iBAAWK,YAAX,CAAwB,KAAKxC,WAA7B,EAA0CtB,MAAMsD,MAAN,CAAaI,UAAvD;AACA,MAFD,MAGK;AACJ,WAAKK,WAAL,CAAiB,KAAKzC,WAAtB,EAAmCtB,MAAMsD,MAAN,CAAaI,UAAhD;AACA;AACD;AACD;AACD;;+BAED/C,mDAAqB;AACpB,OAAI,KAAKW,WAAL,KAAqB,IAArB,IAA6B,KAAKA,WAAL,CAAiBoC,UAAjB,KAAgC,IAAjE,EAAuE;AACtE,SAAKpC,WAAL,CAAiBoC,UAAjB,CAA4BM,WAA5B,CAAwC,KAAK1C,WAA7C;AACA;AACD;;+BAEDC,2CAAiB;AAChB,UAAO,KAAKD,WAAZ;AACA;;+BAEDuC,iDAAmB7D,OAAOiE,YAAY;AAC/B,OAAIC,eAAelE,MAAMmE,OAAN,IAAiBnE,MAAMoE,MAA1C;AACA,OAAIC,aAAaJ,WAAWK,YAA5B;AACA,OAAIC,iBAAiBN,WAAWO,SAAhC;AACAD,oBAAiB,CAAjB;AACA,UAAOL,eAAeK,iBAAiBF,aAAa,CAApD;AACH;;+BAEDN,mCAAYU,SAASC,eAAe;AACnCA,iBAAchB,UAAd,CAAyBI,YAAzB,CAAsCW,OAAtC,EAA+CC,cAAc7C,WAA7D;AACA;;+BAGDoB,2BAAQF,YAAYC,aAAa;AAChC,OAAI,KAAKtE,IAAL,KAAcqE,UAAd,IAA4B,KAAK9C,KAAL,KAAe+C,WAA/C,EAA4D;AAC3D,WAAO,IAAP;AACA;;AAED,OAAID,WAAW,CAAX,KAAiBA,WAAW,CAAX,EAAcnE,EAAnC,EAAuC;AACtC,WAAO,CAAC,KAAK+F,gBAAL,CAAsB,KAAKjG,IAAL,CAAU,KAAKuB,KAAf,CAAtB,EAA6C8C,WAAW,CAAX,EAAcnE,EAA3D,CAAR;AACA;AACD,UAAO,IAAP;AACA;;+BAED+F,6CAAiB9F,MAAMD,IAAI;AAC1B,OAAIC,KAAKD,EAAL,KAAYA,EAAhB,EAAoB;AAClB,WAAO,IAAP;AACD;AACD,QAAK,IAAIuD,IAAI,CAAb,EAAgBA,IAAItD,KAAKH,IAAL,CAAU0D,MAA9B,EAAsCD,GAAtC,EAA2C;AAC1C,QAAIyC,IAAI/F,KAAKH,IAAL,CAAUyD,CAAV,CAAR;AACA,WAAO,KAAKwC,gBAAL,CAAsB9F,KAAKH,IAAL,CAAUyD,CAAV,CAAtB,EAAoCvD,EAApC,CAAP;AACA;AACD,UAAO,KAAP;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;KCxGQiG,kBAAAA,kBADZ,8BAAOvC,OAAP;;;AAKA,mBAAY3C,OAAZ,EAAqBC,UAArB,EAAiC;AAAA;;AAAA,gDAChC,4BAAMD,OAAN,EAAeC,UAAf,CADgC;;AAAA,SAFjCE,wBAEiC,GAFN,KAEM;AAAA;AAEhC;;oBAED6C,2CAAgB3C,OAAO;AACtBb,WAAQC,GAAR,CAAY,kBAAZ;AACA;;;;;;;;;;;oBCfa;AACb0F,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;UCUCC,YAAAA;;;;;;;;;;AANhBC,UAAQC,MAAR,CAAe;AACbC,cAAU;AACRC,wBAAkB;AADV;AADG,GAAf;;AAMO,WAASJ,SAAT,CAAmBK,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYV,KAAhB,EAAuB;AACrBO,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYV,OAAhB,EAAyB;AACvBM,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;UCxBeb,YAAAA;AAAT,WAASA,SAAT,CAAmBE,MAAnB,EAA2B,CAEjC;;ACFD;ACAA;ACAA;ACAA","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n    this.message = 'Drag and Drop Lists with Aurelia';\n  }\n  \n  list = [\n\t\t{\n\t\t\ttype : \"A\",\n\t\t\tid : \"0\",\n\t\t\titem : \"Upper A\",\n\t\t\tdraggable : false,\n\t\t\tlist: [\n\t\t\t\t{\n\t\t\t\t\ttype : \"A\",\n\t\t\t\t\titem : \"From A\",\n\t\t\t\t\tid : \"1\",\n\t\t\t\t\tdraggable : true,\n\t\t\t\t\tlist : [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype : \"A\",\n\t\t\t\t\t\t\tid : \"2\",\n\t\t\t\t\t\t\titem : \"in from a\",\n\t\t\t\t\t\t\tdraggable : true,\n\t\t\t\t\t\t\tlist : []\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype : \"A\",\n\t\t\t\t\t\t\tid : \"3\",\n\t\t\t\t\t\t\titem : \"in from a\",\n\t\t\t\t\t\t\tdraggable : true,\n\t\t\t\t\t\t\tlist : []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\t\n\t\t},\n\t\t{\n\t\t\ttype : \"B\",\n\t\t    id : \"4\",\n\t\t    item : \"Upper B\",\n\t\t    draggable : true,\n\t\t\tlist : [\n\t\t\t\t{\n\t\t\t\t\ttype : \"B\",\n\t\t\t\t\titem : \"From B\",\n\t\t\t\t\tid : \"5\",\n\t\t\t\t\tdraggable : true\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t];\n\t\n\tlist2 = [\n\t\t{\n\t\t\ttype : \"A\",\n\t\t\tid : \"6\",\n\t\t\titem : \"Upper A\",\n\t\t\tdraggable : true,\n\t\t\tlist: [\n\t\t\t\t{\n\t\t\t\t\ttype : \"A\",\n\t\t\t\t\titem : \"From A\",\n\t\t\t\t\tid : \"7\",\n\t\t\t\t\tdraggable : true,\n\t\t\t\t\tlist : [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype : \"A\",\n\t\t\t\t\t\t\tid : \"8\",\n\t\t\t\t\t\t\titem : \"in from a\",\n\t\t\t\t\t\t\tdraggable : true,\n\t\t\t\t\t\t\tlist : []\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype : \"A\",\n\t\t\t\t\t\t\tid : \"9\",\n\t\t\t\t\t\t\titem : \"in from a\",\n\t\t\t\t\t\t\tdraggable : true,\n\t\t\t\t\t\t\tlist : []\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\t\n\t\t},\n\t\t{\n\t\t\ttype : \"B\",\n\t\t    id : \"10\",\n\t\t    item : \"Upper B\",\n\t\t    draggable : true,\n\t\t\tlist : []\n\t\t}\n\t];\n\t\n\tlist3 = [{}];\n\t\n\ttoString(list) {\n\t\tconsole.log(JSON.stringify(list));\n\t\treturn JSON.stringify(list);\n\t}\n}\n","import {bindable, bindingMode} from 'aurelia-framework';\n\nexport class DraggableItem {\n\teffect = \"move\";\n\tenforceTypeCompatibility = true;\n\t\n\t@bindable({ defaultBindingMode: bindingMode.twoWay }) list;\n\t@bindable({ defaultBindingMode: bindingMode.twoWay }) item;\n\t@bindable({ defaultBindingMode: bindingMode.oneWay }) index;\n\t@bindable({ defaultBindingMode: bindingMode.oneWay }) topLevelItem;\n\t\n\tconstructor(element, dndService) {\n\t\tthis.element = element;\n\t\tthis.dndService = dndService;\n\t}\n\t\n\tonDrag(event, index) {\n\t\tthis.onDragCallback(event, index);\n\t}\n\t\n\tonDragStart(event, index) {\n\t\tthis.dndService.initiateDragging(\n\t\t\tthis.list, \n\t\t\tindex, \n\t\t\tthis.element,\n\t\t\tthis.topLevelItem);\n\t   // Add the target element's id to the data transfer object\n\t   event.dataTransfer.setData(\"text\", JSON.stringify(this.list[index]));\n\t   event.dataTransfer.dropEffect = this.effect;\n\t   this.onDragStartCallback(event, index);\n\t\treturn true;\n\t}\n\t\n\tonDragEnd(event, index) {\n\t\tthis.dndService.cleanUpPlaceHolder();\n\t\tthis.onDragEndCallback(event, index);\n\t}\n\t\n\tonDragEndCallback(event, index) {}\n\t\n\tonDragStartCallback(event, index) {}\n\t\n\tonDragCallback(event, index) {}\n}","import {bindable, bindingMode} from 'aurelia-framework';\n\nexport class DropTarget {\n\teffect = \"move\";\n\tenforceTypeCompatibility = false;\n\t\n\t@bindable({ defaultBindingMode: bindingMode.twoWay }) list;\n\t@bindable({ defaultBindingMode: bindingMode.oneWay }) listHead;\n\t\n\tconstructor(element, dndService) {\n\t\tthis.element = element;\n\t\tthis.dndService = dndService;\n\t}\n\t\n\tonDragOver(event, index) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t   this.dndService.addPlaceHolder(event, this.element, this.list);\n\t   event.dataTransfer.dropEffect = this.effect;\n\t   this.onDragOverCallback(event, index);\n\t   return false;\n\t}\n\t\n\tonDrop(event, index) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\t\n\t\tif (this.enforceTypeCompatibility) {\n\t   \t\tif (this.list[index].type !== undefined && this.list[index].type !== data.type) {\n\t   \t\t\treturn;\n\t   \t\t}\n\t   \t}\n\t   \t  \n\t   \tvar placeholder = this.dndService.getPlaceHolder();\n\t\t//Placeholder was not added to list => dragging was not obvious enough\n\t\tif (placeholder === null) {\n\t\t\treturn;\n\t\t}\n\t\t \t \t\n\t   \t//Remove item from list of origin\n\t   \tif (!this.dndService.handleDrop(this.list, index)) {\n\t   \t\treturn;\n\t   \t}\n\t   \t\n\t\tvar data = JSON.parse(event.dataTransfer.getData(\"text\"));\n\t\t\n\t   \tif (this.list[0].type === undefined) {\n\t   \t\tthis.list.splice(0, 1, data);\n\t   \t\tthis.onDropCallback(event);\n\t   \t\treturn;\n\t   \t} \n\t   \t\n\t\tif (placeholder.nextSibling.tagName === \"DND-ITEM\") {\n\t\t\tthis.list.splice(this.getSiblingPositionInList(placeholder.nextSibling), 0, data);\n\t\t}\n\t\telse if (placeholder.previousSibling.tagName === \"DND-ITEM\") {\n\t\t\tthis.list.splice(this.getSiblingPositionInList(placeholder.previousSibling) + 1, 0, data);\n\t\t}\n\t\telse {\n\t\t\tconsole.log(\"Undefined\");\n\t\t}\n\t\t\n\t   this.dndService.cleanUpPlaceHolder();\n\t   this.onDropCallback(event);\n\t}\n\t\n\tgetSiblingPositionInList(sibling) {\n\t\tvar id = sibling.childNodes[1].id;\n\t\tfor (var i = 0; i < this.list.length; i++) {\n\t\t\tif (this.list[i].id === id) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\t\n\tonDropCallback(event, index) {}\n\t\n\tonDragOverCallback(event, index) {}\n}","import {inject, bindable, bindingMode} from 'aurelia-framework';\nimport {DraggableItem} from \"./dnd-draggable-item\";\nimport {DragAndDropService} from './dnd-service';\n\n@inject(Element, DragAndDropService)\nexport class DndItem extends DraggableItem {\n\t//Override\n\t// enforceTypeCompatibility = false;\t\n\t\n\tconstructor(element, dndService) {\n\t\tsuper(element, dndService);\n\t}\n\t\n\tonDragStartCallback(event, index) {\n\t\tthis.element.style.opacity = 0.5;\n\t}\n\t\n\tonDragEndCallback(event, index) {\n\t\tthis.element.style.opacity = 1;\n\t}\n}","import {bindable, bindingMode, inject} from 'aurelia-framework';\nimport {DropTarget} from \"./dnd-drop-target\";\nimport {DragAndDropService} from './dnd-service';\n\n@inject(Element, DragAndDropService)\nexport class DndListImpl extends DropTarget {\t\n\tconstructor(element, dndService) {\n\t\tsuper(element, dndService);\n\t}\n\t\n}","import {bindable, bindingMode} from 'aurelia-framework';\n\nexport class DragAndDropList {\n\teffect = \"move\";\n\tenforceTypeCompatibility = true;\n\t\n\t// @bindable({ defaultBindingMode: bindingMode.twoWay }) list;\n// \t@bindable({ defaultBindingMode: bindingMode.twoWay }) item;\n\t\n\tconstructor(element, dndService) {\n\t\tthis.element = element;\n\t\tthis.dndService = dndService;\n\t\tconsole.log(\"Constructed list item\");\n\t}\n\t\n\tonDrag(event) {\n\t\tconsole.log(\"Dragging ...\");\n\t}\n\t\n\tonDragStart(event, index) {\n\t\tthis.dndService.initiateDragging(this.list, index);\n\t   // Add the target element's id to the data transfer object\n\t   event.dataTransfer.setData(\"text\", JSON.stringify(this.list[index]));\n\t   event.dataTransfer.dropEffect = this.effect;\n\t\treturn true;\n\t}\n\t\n\tonDragOver(event, index) {\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t   this.dndService.addPlaceHolder(event, this.element);\n\t   event.dataTransfer.dropEffect = this.effect;\n\t   //event.dataTransfer.effectAllowed = \"none\";\n\t   return false;\n\t}\n\t\n\tonDrop(event, index) {\n// \t\tconsole.log(event, index);\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t\tindex = index === undefined ? 0 : index;\n\t   var data = JSON.parse(event.dataTransfer.getData(\"text\"));\n\t   \n// \t   console.log(\"data\", data);\n\t   \n\t   if (this.enforceTypeCompatibility) {\n// \t   \t\tconsole.log(this.list.type, data.type);\n\t   \t\tif (this.list[index].type !== undefined && this.list[index].type !== data.type) {\n\t   \t\t\treturn;\n\t   \t\t}\n\t   }\n\t   this.list.splice(index, 0, data);\n\t   this.dndService.handleDrop();\n\t   this.droppedCallback(event);\n\t}\n\t\n\tdroppedCallback(event) {}\n\t\n}","import {inject} from 'aurelia-framework';\nimport {DOM} from 'aurelia-pal';\n\n@inject(DOM)\nexport class DragAndDropService {\n\tisDragging = false;\n\tlist = []; //List reference from which the element is dragged\n\tindex = -1;\n\tplaceholder = null;\n\telement = null;\n\ttopLevelItem = false;\n\t\n\tconstructor(DOM) {\n\t\tthis.DOM = DOM;\n\t}\n\t\n\tinitiateDragging(list, index, element, topLevelItem) {\n\t\tthis.list = list;\n\t\tthis.index = index;\n\t\tthis.element = element;\n\t\tthis.topLevelItem = topLevelItem;\n\t}\n\t\n\thandleDrop(targetList, targetIndex) {\n\t\tif (this.canDrop(targetList, targetIndex)) {\n\t\t\tthis.list.splice(this.index, 1);\n\t\t\t//Return list to original empty state : [{}] for top level items only\n\t\t\tif (this.list.length === 0 && this.topLevelItem) {\n\t\t\t\tthis.list.push({});\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\t\n\tcreatePlaceholder() {\n\t\tvar element = DOM.createElement(\"div\");\n\t\telement.className = \"dndPlaceholder\";\n\t\treturn element;\n\t}\n\t\n\taddPlaceHolder(event, element, list) {\n\t\tif (event.target.classList.contains(\"dndItem\")) {\n\t\t\tvar listHolder = event.target.parentNode.parentNode;\n\t\t\t\n\t\t\tif (this.placeholder === null) {\n\t\t\t\tthis.placeholder = this.createPlaceholder();\n\t\t\t}\n\t\t\t\n\t\t\tif (event.target.isEqualNode(this.element)) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if (list[0].type === undefined) { //Empty list case : [{}]\n\t\t\t\tlistHolder.appendChild(this.placeholder);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (this.isMouseInFirstHalf(event, event.target.parentNode)) {\n\t\t\t\t\tlistHolder.insertBefore(this.placeholder, event.target.parentNode);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.insertAfter(this.placeholder, event.target.parentNode);\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tcleanUpPlaceHolder() {\n\t\tif (this.placeholder !== null && this.placeholder.parentNode !== null) {\n\t\t\tthis.placeholder.parentNode.removeChild(this.placeholder);\n\t\t}\n\t}\n\t\n\tgetPlaceHolder() {\n\t\treturn this.placeholder;\n\t}\n\t\n\tisMouseInFirstHalf(event, targetNode) {\n        var mousePointer = event.offsetY || event.layerY;\n        var targetSize = targetNode.offsetHeight;\n        var targetPosition = targetNode.offsetTop;\n        targetPosition = 0;\n        return mousePointer < targetPosition + targetSize / 2;\n    }\n    \n    insertAfter(newNode, referenceNode) {\n    \treferenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);\n    }\n    \n    //Check if first items id in targetList exists in doner list i. e. if targetList in doner list\n    canDrop(targetList, targetIndex) {\n    \tif (this.list === targetList && this.index !== targetIndex) {\n    \t\treturn true;\n    \t}\n    \t\n    \tif (targetList[0] && targetList[0].id) {\n    \t\treturn !this.idExistsInBranch(this.list[this.index], targetList[0].id);\n    \t}\n    \treturn true; \n    }\n    \n    idExistsInBranch(item, id) {\n    \tif (item.id === id) {\n    \t\t\treturn true;\n    \t}\n    \tfor (var i = 0; i < item.list.length; i++) {\n    \t\tvar l = item.list[i];\n    \t\treturn this.idExistsInBranch(item.list[i], id);\n    \t}\n    \treturn false;\n    }\n}","import {inject} from 'aurelia-framework';\nimport {DragAndDropList} from \"./dnd-list\";\nimport {DragAndDropService} from './dnd-service';\n\n@inject(Element, DragAndDropService)\nexport class DndTest extends DragAndDropList {\n\t//Override\n\tenforceTypeCompatibility = false;\n\t\t\n\tconstructor(element, dndService) {\n\t\tsuper(element, dndService);\n\t}\n\t\n\tdroppedCallback(event) {\n\t\tconsole.log(\"I was dropped!!!\");\n\t}\n}","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\n//Note: You may want to use environment-specific configuration.\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n",null,null,null,null],"sourceRoot":"../src"}